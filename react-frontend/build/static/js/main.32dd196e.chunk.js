(this["webpackJsonpreact-frontend"]=this["webpackJsonpreact-frontend"]||[]).push([[0],{11:function(e,t,n){e.exports=n(25)},16:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var a=n(0),s=n.n(a),r=n(8),i=n.n(r),c=(n(16),n(9)),o=n(2),l=n.n(o),u=n(10),p=n(3),m=n(1),f=n.n(m);n(23),n(24);function g(e){var t,n=e.message,a=e.transcript,r=e.startSession,i=e.closeSession,c=e.state,o=e.intentResponse,l=e.updateState;if("ambient"===c)t=function(e){var t=e.startSession;return s.a.createElement("img",{className:"pi-ambient",onClick:function(){return t()},src:"pi-ambient.gif",alt:""})}({startSession:r});else if("listening"===c)t=d({closeSession:i,greeting:"listening...",state:c,transcript:a});else if("processing"===c)t=d({closeSession:i,greeting:"thinking...",state:c});else{if("sleep"===c)return function(e){var t=e.updateState;return s.a.createElement("div",{className:"pi-sleep-container",onClick:function(){return t("ambient")}})}({updateState:l});"response"===c&&(t=function(e){var t=e.intentResponse,n=e.message,a=e.updateState;return s.a.createElement("div",{className:"pi-active-container",onClick:function(){return a("ambient")}},s.a.createElement("h1",{className:"pi-greeting"},s.a.createElement("em",null,t)),s.a.createElement("div",{className:"pi-transcript-wrapper"},s.a.createElement("p",{className:"pi-transcript"},s.a.createElement("em",null,n))))}({intentResponse:o,message:n,updateState:l}))}return s.a.createElement("div",{className:"pi-wrapper"},t,s.a.createElement("link",{href:"https://fonts.googleapis.com/css2?family=Montserrat:wght@400&display=swap",rel:"stylesheet"}))}function d(e){var t=e.closeSession,n=e.greeting,a=e.state,r=e.transcript,i="listening"===a?s.a.createElement("img",{src:"./pi-listening.gif",className:"pi-listening",alt:""}):s.a.createElement("div",{className:"spinner"},s.a.createElement("div",{className:"bounce1"}),s.a.createElement("div",{className:"bounce2"}),s.a.createElement("div",{className:"bounce3"}));return s.a.createElement("div",{onClick:function(){return t()},className:"pi-active-container"},s.a.createElement("h1",{className:"pi-greeting"},s.a.createElement("em",null,n)),s.a.createElement("div",{className:"pi-transcript-wrapper"},s.a.createElement("p",{className:"pi-transcript"},s.a.createElement("em",null,r))),i)}var v=function(e){var t=e.transcript,n=e.setMessage,a=e.setIntent,s=e.updateState,r=e.onAudioFinish,i=function(){var e=localStorage.getItem("api_key");return e||(e=prompt("Enter device api key"),localStorage.setItem("api_key",e)),e}(),c="https://api.sahilkapur.com",o="?transcript="+t.toLowerCase();try{fetch(c+"/setIntent"+o,{headers:{api_key:i}}).then((function(e){if(200===e.status)return e.json();throw n("Error in request"),s("Error"),Error("Request rejected")})).then((function(e){var t=e.intent,i=e.message;a(t),n(i),s("response"),function(e){var t=e.data,n=e.updateState,a=t.message,s=t.intent;"launch"===s?window.open(t.url):"hardwareSleepIntent"===s||"closeShopIntent"===s?n("sleep"):"pullLatestVersion"===s&&t.update&&setTimeout((function(){return window.location.reload()}),6e3)}({data:e,updateState:s});var o=new Audio(c+"/audioFile?fileName="+e.fileName);o.play(),o.addEventListener("ended",(function(e){return r(e)}))})).catch((function(e){console.error(e),s("error"),n(e.message)}))}catch(l){alert()}};var h=function(){var e=Object(a.useState)(null),t=Object(p.a)(e,2),n=t[0],r=t[1],i=Object(m.useSpeechRecognition)(),o=i.listening,d=i.transcript,h=i.resetTranscript,E=Object(a.useState)("ambient"),w=Object(p.a)(E,2),b=w[0],S=w[1],N=Object(a.useState)("Hello, Sahil."),y=Object(p.a)(N,2),j=y[0],k=y[1],O=Object(a.useState)(null),L=Object(p.a)(O,2),I=L[0],C=L[1];Object(a.useEffect)((function(){f.a.browserSupportsSpeechRecognition()||alert("Unsupported Browser")}),[]),console.log(b),"sleep"===b&&o?f.a.stopListening():"sleep"===b||o||f.a.startListening({continuous:!0});var R=function(){k("Go ahead..."),r(new Date),S("listening"),f.a.startListening({continuous:!0})},_=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:k("processing..."),S("processing"),t=function(){h(),f.a.startListening({continuous:!0})},f.a.stopListening(),v({transcript:d,setMessage:k,setIntent:C,updateState:S,onAudioFinish:t});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){r(new Date)}),[d]),"listening"!==b&&(d.toLowerCase().includes("ultron")?(h(),R()):o&&"response"===b&&d.toLowerCase().includes("clear")&&(h(),S("ambient"))),function(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}((function(){if(""!==d&&"listening"===b){var e=(new Date-n)/1e3,t=3;d.includes("add weight")&&(t=60);if(d.includes("add weight")){var a,s=!0,r=Object(c.a)(["lb","bmi","bone mass","body fat","muscle mass","send"]);try{for(r.s();!(a=r.n()).done;){var i=a.value;d.toLowerCase().includes(i)||(console.log("missing "+i),s=!1)}}catch(o){r.e(o)}finally{r.f()}s&&(t=0)}e>t&&_()}}),""!==d&&"listening"===b?1e3:null);var M={message:j,intentResponse:I,transcript:"listening"===b?d:"",startSession:R,state:b,updateState:S},A=window.location.search;return"pi"===new URLSearchParams(A).get("device")?g(M):function(e){var t=e.message,n=e.listening,a=e.stopListening,r=e.startSession,i=e.transcript;return s.a.createElement("div",{className:"app-container"},s.a.createElement("h2",{className:"greeting"},t),s.a.createElement("div",{className:"voice-icon-wrapper",onClick:function(){n?a():r({continuous:!0})}},s.a.createElement("img",{className:"voice-icon",src:"https://cdn.dribbble.com/users/32512/screenshots/5668419/calm_ai_design_by_gleb.gif",alt:""})),s.a.createElement("p",{className:"transcript"},s.a.createElement("em",null,i)),s.a.createElement("link",{href:"https://fonts.googleapis.com/css2?family=Montserrat:wght@200&display=swap",rel:"stylesheet"}))}(M)};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(h,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[11,1,2]]]);
//# sourceMappingURL=main.32dd196e.chunk.js.map